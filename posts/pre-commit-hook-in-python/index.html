<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2021-03-13">
<meta name="description" content="Pre-commit Hook Configuration">

<title>Jaber’s Blog - পাইথনে প্রি-কমিট হুকের সাথে পরিচিতি(Introduction to Pre-commit Hook in Python)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<style>
    .quarto-title-block .quarto-title-banner {
      color: #4a6c6f;
background: #F1F1F1;
    }
    </style>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Jaber’s Blog</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/jabertuhin"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/jabertuhin"><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">পাইথনে প্রি-কমিট হুকের সাথে পরিচিতি(Introduction to Pre-commit Hook in Python)</h1>
                  <div>
        <div class="description">
          Pre-commit Hook Configuration
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">Pre-commit Hook</div>
                <div class="quarto-category">Git</div>
                <div class="quarto-category">Python</div>
                <div class="quarto-category">Bangla</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">March 13, 2021</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#কন-pre-commit-hook-পরয়জন" id="toc-কন-pre-commit-hook-পরয়জন" class="nav-link active" data-scroll-target="#কন-pre-commit-hook-পরয়জন">কেন pre-commit hook প্রয়োজন</a></li>
  <li><a href="#pre-commit-পযকজ-ইনসটলশন" id="toc-pre-commit-পযকজ-ইনসটলশন" class="nav-link" data-scroll-target="#pre-commit-পযকজ-ইনসটলশন">pre-commit প্যাকেজ ইন্সটলেশন</a></li>
  <li><a href="#pre-commit-config.yaml--এর-মধযম-কনফগরশন" id="toc-pre-commit-config.yaml--এর-মধযম-কনফগরশন" class="nav-link" data-scroll-target="#pre-commit-config.yaml--এর-মধযম-কনফগরশন">.pre-commit-config.yaml -এর মাধ্যমে কনফিগারেশন</a>
  <ul class="collapse">
  <li><a href="#pre-commit-hooks" id="toc-pre-commit-hooks" class="nav-link" data-scroll-target="#pre-commit-hooks">pre-commit-hooks</a></li>
  <li><a href="#flake8" id="toc-flake8" class="nav-link" data-scroll-target="#flake8">flake8</a></li>
  <li><a href="#mypy" id="toc-mypy" class="nav-link" data-scroll-target="#mypy">mypy</a></li>
  <li><a href="#tests" id="toc-tests" class="nav-link" data-scroll-target="#tests">tests</a></li>
  <li><a href="#উদহরণ" id="toc-উদহরণ" class="nav-link" data-scroll-target="#উদহরণ">উদাহরণ</a></li>
  </ul></li>
  <li><a href="#ci-পইপলইন-পর-কমট-হক-চক" id="toc-ci-পইপলইন-পর-কমট-হক-চক" class="nav-link" data-scroll-target="#ci-পইপলইন-পর-কমট-হক-চক">CI পাইপলাইনে প্রি-কমিট হুক চেকিং</a>
  <ul class="collapse">
  <li><a href="#bitbucket-pipeline-example" id="toc-bitbucket-pipeline-example" class="nav-link" data-scroll-target="#bitbucket-pipeline-example">Bitbucket Pipeline Example</a></li>
  <li><a href="#github-action-pipeline-example" id="toc-github-action-pipeline-example" class="nav-link" data-scroll-target="#github-action-pipeline-example">Github Action Pipeline Example:</a></li>
  </ul></li>
  <li><a href="#resources" id="toc-resources" class="nav-link" data-scroll-target="#resources">Resources</a></li>
  <li><a href="#update-log" id="toc-update-log" class="nav-link" data-scroll-target="#update-log">UPDATE Log</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p>প্রি-কমিট হুকের সাথে পরিচিতি Vladimir Iglovikov এর ব্লগ <a href="https://towardsdatascience.com/nine-simple-steps-for-better-looking-python-code-87e5d9d3b1cf">Nine simple steps for better-looking python code</a> পোস্টের মাধ্যমে। আমার কাছে খুবই ইন্টারেস্টিং কনসেপ্ট মনে হয়েছে, তাই এই ব্যাপারে একটা ব্লগ লিখা। পাইথন প্রজেক্টের ক্ষেত্রে কিভাবে আমরা pre-commit hook ব্যবহার করতে পারি, তা নিয়েই এই ব্লগ পোস্ট।</p>
<section id="কন-pre-commit-hook-পরয়জন" class="level2">
<h2 class="anchored" data-anchor-id="কন-pre-commit-hook-পরয়জন">কেন pre-commit hook প্রয়োজন</h2>
<p>আমরা যখন একটা প্রজেক্টে কাজ করি- তখন সেখানে কয়েকজন ডেভলপার থাকে, একজন অন্যজনের কোড রিভিউ করে। পুল-রিকুয়েস্ট রিভিউ করার সময় আমাদের মূল ফোকাস যেন কোডের লজিক, ডিজাইন ইত্যাদি গুরুত্ব পূর্ণ বিষয়গুলোতে বেশি থাকে। আমার কলিগের পুল-রিকুয়েস্ট যেন একটা এক্সট্রা স্পেস কিংবা এক্সট্রা নিউ লাইনের জন্য ঝুলে না থাকে। ল্যাঙ্গুয়েজ স্পেসিফিক বেস্ট প্র্যাকটিস যেন আমরা আরেকটা টুলসের মাধ্যমে নিশ্চিত করতে পারি।</p>
<p>তাছাড়া ডেভলপাররাও বিভিন্ন সময় ভুল করে- সেই ভুল হতে পারে ডেভলপমেন্ট/মাস্টার ব্রাঞ্চে ভুল করে কমিট করা, কোন একটা লার্জ ফাইল গিট ইগ্নোর না করায় তা কমিট হয়ে যাওয়া, গিট পুশ করার আগে ইউনিট টেস্টগুলো সব পাস হচ্ছে নাকি তা চেক না করেই পুল-রিকুয়েস্ট ক্রিয়েট করে ফেলা।</p>
<p>এইসব বিভিন্ন ধরনের চেকিং আমরা চাইলে আমাদের কমিট করার আগে করতে পারি। সেটার জন্যই আমরা আজকে একটা পাইথন প্রজেক্টে pre-commit hook কিভাবে ব্যবহার করতে হয় তা দেখবো।</p>
</section>
<section id="pre-commit-পযকজ-ইনসটলশন" class="level2">
<h2 class="anchored" data-anchor-id="pre-commit-পযকজ-ইনসটলশন">pre-commit প্যাকেজ ইন্সটলেশন</h2>
<p>আমাদের প্রজেক্টে প্রথমে pre-commit পাইথন প্যাকেজ ইন্সটল করতে হবে, এবং এই প্যাকেজ ব্যবহার করে আমরা pre-commit ও pre-push - git hooks ইন্সটল করবো।</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource shell number-lines code-with-copy"><code class="sourceCode"><span id="cb1-1"><a href="#cb1-1"></a>pip install pre-commit</span>
<span id="cb1-2"><a href="#cb1-2"></a>pre-commit install --hook-type pre-commit --hook-type pre-push</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>এই pre-commit প্যাকেজকে আমরা requirements.dev.text তেও এড করে দিবো, কারণ এই প্যাকেজটা শুধু ডেভলপমেন্টের সময় লাগবে।</p>
</section>
<section id="pre-commit-config.yaml--এর-মধযম-কনফগরশন" class="level2">
<h2 class="anchored" data-anchor-id="pre-commit-config.yaml--এর-মধযম-কনফগরশন">.pre-commit-config.yaml -এর মাধ্যমে কনফিগারেশন</h2>
<p>এখন আসি, কিভাবে আমাদের pre-commit hook কে কনফিগার করবো। .pre-commit-config.yaml ফাইলে আমরা আমাদের প্রয়োজন অনুযায়ী কনফিগারশন করবো, আর সেটিকে প্রজেক্ট রুটে রাখবো। নিম্নে আমার একটা টয় প্রজেক্টের .pre-commit-config.yaml ফাইল দেয়া হলো -</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode numberSource yaml number-lines code-with-copy"><code class="sourceCode yaml"><span id="cb2-1"><a href="#cb2-1"></a><span class="fu">repos</span><span class="kw">:</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">repo</span><span class="kw">:</span><span class="at"> https://github.com/pre-commit/pre-commit-hooks</span></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="at">    </span><span class="fu">rev</span><span class="kw">:</span><span class="at"> v3.4.0</span></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="at">    </span><span class="fu">hooks</span><span class="kw">:</span></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">id</span><span class="kw">:</span><span class="at"> trailing-whitespace</span></span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">id</span><span class="kw">:</span><span class="at"> check-added-large-files</span></span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">id</span><span class="kw">:</span><span class="at"> no-commit-to-branch</span></span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">id</span><span class="kw">:</span><span class="at"> check-yaml      </span></span>
<span id="cb2-9"><a href="#cb2-9"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">repo</span><span class="kw">:</span><span class="at"> https://gitlab.com/pycqa/flake8</span></span>
<span id="cb2-10"><a href="#cb2-10"></a><span class="at">    </span><span class="fu">rev</span><span class="kw">:</span><span class="at"> </span><span class="fl">3.8.4</span></span>
<span id="cb2-11"><a href="#cb2-11"></a><span class="at">    </span><span class="fu">hooks</span><span class="kw">:</span></span>
<span id="cb2-12"><a href="#cb2-12"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">id</span><span class="kw">:</span><span class="at"> flake8    </span></span>
<span id="cb2-13"><a href="#cb2-13"></a><span class="at">      </span><span class="fu">stages</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">commit</span><span class="kw">]</span></span>
<span id="cb2-14"><a href="#cb2-14"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">repo</span><span class="kw">:</span><span class="at"> https://github.com/pre-commit/mirrors-mypy</span></span>
<span id="cb2-15"><a href="#cb2-15"></a><span class="at">    </span><span class="fu">rev</span><span class="kw">:</span><span class="at"> v0.812</span></span>
<span id="cb2-16"><a href="#cb2-16"></a><span class="at">    </span><span class="fu">hooks</span><span class="kw">:</span></span>
<span id="cb2-17"><a href="#cb2-17"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">id</span><span class="kw">:</span><span class="at"> mypy</span></span>
<span id="cb2-18"><a href="#cb2-18"></a><span class="at">      </span><span class="fu">additional_dependencies</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">tokenize-rt==</span><span class="fl">3.2.0</span><span class="kw">]</span></span>
<span id="cb2-19"><a href="#cb2-19"></a><span class="at">      </span><span class="fu">stages</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">commit</span><span class="kw">]</span></span>
<span id="cb2-20"><a href="#cb2-20"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">repo</span><span class="kw">:</span><span class="at"> local</span></span>
<span id="cb2-21"><a href="#cb2-21"></a><span class="at">    </span><span class="fu">hooks</span><span class="kw">:</span></span>
<span id="cb2-22"><a href="#cb2-22"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">id</span><span class="kw">:</span><span class="at"> tests</span></span>
<span id="cb2-23"><a href="#cb2-23"></a><span class="at">      </span><span class="fu">name</span><span class="kw">:</span><span class="at"> run tests</span></span>
<span id="cb2-24"><a href="#cb2-24"></a><span class="at">      </span><span class="fu">entry</span><span class="kw">:</span><span class="at"> pytest -v</span></span>
<span id="cb2-25"><a href="#cb2-25"></a><span class="at">      </span><span class="fu">language</span><span class="kw">:</span><span class="at"> system</span></span>
<span id="cb2-26"><a href="#cb2-26"></a><span class="at">      </span><span class="fu">always_run</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb2-27"><a href="#cb2-27"></a><span class="at">      </span><span class="fu">types</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">python</span><span class="kw">]</span></span>
<span id="cb2-28"><a href="#cb2-28"></a><span class="at">      </span><span class="fu">stages</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">push</span><span class="kw">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="pre-commit-hooks" class="level3">
<h3 class="anchored" data-anchor-id="pre-commit-hooks">pre-commit-hooks</h3>
<p>প্রথম যে রিপোটা আমরা ব্যবহার করছি তা হলো <code>pre-commit-hooks</code>, এ আমাদেরকে বেশকিছু চেকিং এবং ফিক্সিং আউট-অফ-দা-বক্স সাপোর্ট দেয়। যেমন, আমাদের ফাইলে খেয়াল করলে hooks এর নিচে দেখতে পাচ্ছি প্রথম id হলো <code>trailing-whitespace</code> , যেটা আমার কোডের প্রতি লাইনের শেষের এক্সট্রা স্পেসগুলি রিমুভ করে দিবে এবং সেক্ষেত্রে আপনার কমিট ফেইল করবে। আমাদেরকে তখন নতুন করে স্পেসিফিক ফাইলকে স্টেজ করে কমিট করতে হবে, কারণ প্রয়োজনীয় চেঞ্জ আমাকে করে দিয়েছি এই hook । এরপরের আইডি হলো- <code>check-added-large-files</code>, এর ডিফল্ট ভ্যালু ৫০০ KB দেয়া। এর চেয়ে বড় ফাইল আপনি কমিট করতে চাইলে, সেটা এই চেকিং এ ধরা পড়বে এবং আপনি কমিট করতে পারবেন না। <code>no-commit-to-branch</code> এটা দিয়ে আমি নিশ্চিত করতে পারবো কেউ যেন সরাসরি মাস্টার ব্রাঞ্চে কমিট করতে না পারে(আর্গুমেন্ট দিয়ে আমরা অন্য ব্রাঞ্চও কনফিগার করতে পারবো।), <code>check-yaml</code> আইডি দিয়ে আমরা yaml ফাইলের ফরম্যাটিং চেক করতে পারবো। আরও জানার জন্য গিটহাব রিপো দেখুন - <a href="https://github.com/pre-commit/pre-commit-hooks">pre-commit-hooks</a></p>
</section>
<section id="flake8" class="level3">
<h3 class="anchored" data-anchor-id="flake8">flake8</h3>
<p>এরপরে পাইথনে স্টাইল গাইড ফলো করার জন্য আমরা <code>flake8</code> রিপো ব্যবহার করবো, যে পাইথন ফাইলগুলো আমি কমিট করতে চাচ্ছি সেগুলো সকল স্টাইলিং গাইড মেইনটেইন করছে কি-না, না করলে কোন ফাইলের কোথায় ইস্যু সেটা বলে দিবে। আর এখানে আমরা stages এ বলে দিচ্ছি - <strong>commit</strong>, যেন শুধু <em>git commit</em> এর সময়ই এই চেকিং টা হয়। flake8 সম্পর্কে জানার জন্য তাদের গিটহাব রিপো দেখুন - <a href="https://github.com/PyCQA/flake8">flake8 - Github</a></p>
</section>
<section id="mypy" class="level3">
<h3 class="anchored" data-anchor-id="mypy">mypy</h3>
<p>তৃতীয়ত আসছে mypy, পাইথনের টাইপ চেকিং এর জন্য। এই প্যাকেজের নিজস্ব কোন ডিপেন্ডেন্সি থাকলে সেটাও আমরা উল্লেখ করে দিতে পারি <code>additional_dependencies</code> এর মাধ্যমে। mypy সম্পর্কে জানার জন্য তাদের ডকুমেন্টেশন পেজ দেখুন - <a href="https://mypy.readthedocs.io/en/stable/introduction.html">Mypy Introduction</a></p>
</section>
<section id="tests" class="level3">
<h3 class="anchored" data-anchor-id="tests">tests</h3>
<p>সর্বশেষে আসছে, ইউনিট টেস্ট রান করা। আমি আমার ইউনিট টেস্ট রান করতে চাই <em>git push</em> করার সময়ে, সে জন্য এখানে আমার <code>stages</code> এ শুধু <strong>push</strong> বলা আছে। আর <strong>pytest</strong> এর মাধ্যমে আমার টেস্ট রান করতে বলছি <code>entry</code> তে। <code>always_run</code> ব্যবহার করে আমরা বলে দিচ্ছি যেন সবসময় <strong>push</strong> করার আগে টেস্ট ফাইলগুলো রান করে।</p>
</section>
<section id="উদহরণ" class="level3">
<h3 class="anchored" data-anchor-id="উদহরণ">উদাহরণ</h3>
<p>আমি আমার প্রজেক্টের <em>requirements.txt</em> থেকে একটা প্যাকেজ রিমুভ করে দিয়ে, একটা কমিট করি। যেহেতু এটা পাইথন ফাইল না, পাইথন স্পেসিফিক হুকগুলো এখানে রান করে নি। <img src="git-commit.png" class="img-fluid" alt="“pre-commit hooks executing during commit.”"></p>
<p>পরবর্তীতে আমি এই চেঞ্জ যখন push করি তখন কমিট স্পেসিফিক চেকিং গুলো হয় নি, আর push এর সময় টেস্ট রান করতে বলেছিলাম সেই টেস্ট রান হয়েছে। <img src="git-push.png" class="img-fluid" alt="“pre-commit hooks executing during push.”"></p>
</section>
</section>
<section id="ci-পইপলইন-পর-কমট-হক-চক" class="level2">
<h2 class="anchored" data-anchor-id="ci-পইপলইন-পর-কমট-হক-চক">CI পাইপলাইনে প্রি-কমিট হুক চেকিং</h2>
<section id="bitbucket-pipeline-example" class="level3">
<h3 class="anchored" data-anchor-id="bitbucket-pipeline-example">Bitbucket Pipeline Example</h3>
<p>Bitbucket পাইপলাইনে মাল্টিপল স্টেপ প্যারালালি রান করা যায়। এর ফলে CI রান করার ওয়েটিং টাইমটা কমিয়ে ফেলা যায়।</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode numberSource yaml number-lines code-with-copy"><code class="sourceCode yaml"><span id="cb3-1"><a href="#cb3-1"></a><span class="fu">image</span><span class="kw">:</span><span class="at"> python:3.8</span></span>
<span id="cb3-2"><a href="#cb3-2"></a></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="fu">definitions</span><span class="kw">:</span></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="at">  </span><span class="fu">steps</span><span class="kw">:</span></span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">step</span><span class="kw">:</span><span class="at"> </span><span class="ot">&amp;coverage</span></span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="at">        </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Running Test</span></span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="at">        </span><span class="fu">size</span><span class="kw">:</span><span class="at"> 2x</span></span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="at">        </span><span class="fu">caches</span><span class="kw">:</span></span>
<span id="cb3-9"><a href="#cb3-9"></a><span class="at">          </span><span class="kw">-</span><span class="at"> pip        </span></span>
<span id="cb3-10"><a href="#cb3-10"></a><span class="at">        </span><span class="fu">script</span><span class="kw">:</span><span class="at">          </span></span>
<span id="cb3-11"><a href="#cb3-11"></a><span class="at">          </span><span class="kw">-</span><span class="at"> pip install -r requirements.dev.txt</span></span>
<span id="cb3-12"><a href="#cb3-12"></a><span class="at">          </span><span class="kw">-</span><span class="at"> pytest</span></span>
<span id="cb3-13"><a href="#cb3-13"></a></span>
<span id="cb3-14"><a href="#cb3-14"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">step</span><span class="kw">:</span><span class="at"> </span><span class="ot">&amp;pre_commit</span></span>
<span id="cb3-15"><a href="#cb3-15"></a><span class="at">        </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Pre-Commit Hook Checking</span></span>
<span id="cb3-16"><a href="#cb3-16"></a><span class="at">        </span><span class="fu">caches</span><span class="kw">:</span></span>
<span id="cb3-17"><a href="#cb3-17"></a><span class="at">          </span><span class="kw">-</span><span class="at"> pip        </span></span>
<span id="cb3-18"><a href="#cb3-18"></a><span class="at">        </span><span class="fu">script</span><span class="kw">:</span></span>
<span id="cb3-19"><a href="#cb3-19"></a><span class="at">          </span><span class="kw">-</span><span class="at"> pip install pre-commit==2.17.0</span></span>
<span id="cb3-20"><a href="#cb3-20"></a><span class="at">          </span><span class="kw">-</span><span class="at"> pre-commit run --all-files</span></span>
<span id="cb3-21"><a href="#cb3-21"></a></span>
<span id="cb3-22"><a href="#cb3-22"></a><span class="fu">pipelines</span><span class="kw">:</span></span>
<span id="cb3-23"><a href="#cb3-23"></a><span class="at">  </span><span class="fu">branches</span><span class="kw">:</span></span>
<span id="cb3-24"><a href="#cb3-24"></a><span class="at">    </span><span class="fu">development</span><span class="kw">:</span></span>
<span id="cb3-25"><a href="#cb3-25"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">parallel</span><span class="kw">:</span></span>
<span id="cb3-26"><a href="#cb3-26"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">step</span><span class="kw">:</span><span class="at"> </span><span class="ot">*coverage</span></span>
<span id="cb3-27"><a href="#cb3-27"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">step</span><span class="kw">:</span><span class="at"> </span><span class="ot">*pre_commit</span></span>
<span id="cb3-28"><a href="#cb3-28"></a></span>
<span id="cb3-29"><a href="#cb3-29"></a><span class="at">  </span><span class="fu">pull-requests</span><span class="kw">:</span></span>
<span id="cb3-30"><a href="#cb3-30"></a><span class="at">    </span><span class="fu">'**'</span><span class="kw">:</span></span>
<span id="cb3-31"><a href="#cb3-31"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">parallel</span><span class="kw">:</span></span>
<span id="cb3-32"><a href="#cb3-32"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">step</span><span class="kw">:</span><span class="at"> </span><span class="ot">*coverage</span></span>
<span id="cb3-33"><a href="#cb3-33"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">step</span><span class="kw">:</span><span class="at"> </span><span class="ot">*pre_commit</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="github-action-pipeline-example" class="level3">
<h3 class="anchored" data-anchor-id="github-action-pipeline-example">Github Action Pipeline Example:</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode numberSource yaml number-lines code-with-copy"><code class="sourceCode yaml"><span id="cb4-1"><a href="#cb4-1"></a><span class="fu">name</span><span class="kw">:</span><span class="at"> Continuous Integration</span></span>
<span id="cb4-2"><a href="#cb4-2"></a></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="fu">on</span><span class="kw">:</span></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="at">  </span><span class="fu">push</span><span class="kw">:</span></span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="at">    </span><span class="fu">branches</span><span class="kw">:</span></span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="at">      </span><span class="kw">-</span><span class="at"> development</span></span>
<span id="cb4-7"><a href="#cb4-7"></a></span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="at">  </span><span class="fu">pull_request</span><span class="kw">:</span></span>
<span id="cb4-9"><a href="#cb4-9"></a><span class="at">    </span><span class="fu">branches</span><span class="kw">:</span></span>
<span id="cb4-10"><a href="#cb4-10"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="st">"**"</span></span>
<span id="cb4-11"><a href="#cb4-11"></a></span>
<span id="cb4-12"><a href="#cb4-12"></a><span class="fu">jobs</span><span class="kw">:</span></span>
<span id="cb4-13"><a href="#cb4-13"></a><span class="at">  </span><span class="fu">build</span><span class="kw">:</span></span>
<span id="cb4-14"><a href="#cb4-14"></a><span class="at">    </span><span class="fu">runs-on</span><span class="kw">:</span><span class="at"> ubuntu-latest</span></span>
<span id="cb4-15"><a href="#cb4-15"></a><span class="at">    </span><span class="fu">steps</span><span class="kw">:</span></span>
<span id="cb4-16"><a href="#cb4-16"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">uses</span><span class="kw">:</span><span class="at"> actions/checkout@v2</span></span>
<span id="cb4-17"><a href="#cb4-17"></a></span>
<span id="cb4-18"><a href="#cb4-18"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Set up Python</span></span>
<span id="cb4-19"><a href="#cb4-19"></a><span class="at">        </span><span class="fu">uses</span><span class="kw">:</span><span class="at"> actions/setup-python@v2</span></span>
<span id="cb4-20"><a href="#cb4-20"></a><span class="at">        </span><span class="fu">with</span><span class="kw">:</span></span>
<span id="cb4-21"><a href="#cb4-21"></a><span class="at">          </span><span class="fu">python-version</span><span class="kw">:</span><span class="at"> </span><span class="st">'3.8'</span></span>
<span id="cb4-22"><a href="#cb4-22"></a></span>
<span id="cb4-23"><a href="#cb4-23"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Install dependencies</span></span>
<span id="cb4-24"><a href="#cb4-24"></a><span class="fu">        run</span><span class="kw">: </span><span class="ch">|</span></span>
<span id="cb4-25"><a href="#cb4-25"></a>          python -m pip install --upgrade pip</span>
<span id="cb4-26"><a href="#cb4-26"></a>          make dev_setup</span>
<span id="cb4-27"><a href="#cb4-27"></a></span>
<span id="cb4-28"><a href="#cb4-28"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Test with pytest</span></span>
<span id="cb4-29"><a href="#cb4-29"></a><span class="fu">        run</span><span class="kw">: </span><span class="ch">|</span></span>
<span id="cb4-30"><a href="#cb4-30"></a>          make test</span>
<span id="cb4-31"><a href="#cb4-31"></a></span>
<span id="cb4-32"><a href="#cb4-32"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Pre-Commit Hook Checking</span></span>
<span id="cb4-33"><a href="#cb4-33"></a><span class="fu">        run</span><span class="kw">: </span><span class="ch">|</span></span>
<span id="cb4-34"><a href="#cb4-34"></a>          pre-commit run --all-files</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="resources" class="level2">
<h2 class="anchored" data-anchor-id="resources">Resources</h2>
<ul>
<li><p><a href="https://ljvmiranda921.github.io/notebook/2018/06/21/precommits-using-black-and-flake8/">Automate Python workflow using pre-commits: black and flake8</a></p></li>
<li><p><a href="https://github.com/pre-commit/pre-commit-hooks">pre-commit-hooks</a></p></li>
<li><p><a href="https://pre-commit.com/hooks.html">Supported hooks</a></p></li>
<li><p><a href="https://git-scm.com/book/en/v2/Customizing-Git-Git-Hooks">Customizing Git - Git Hooks</a></p></li>
<li><p><a href="https://pre-commit.com/">pre-commit</a></p></li>
<li><p><a href="https://luminousmen.com/post/my-unpopular-opinion-about-black-code-formatter">My unpopular opinion about black code formatter</a></p></li>
<li><p><a href="https://support.atlassian.com/bitbucket-cloud/docs/set-up-or-run-parallel-steps/">[Bitbucket] Set up or run parallel steps</a></p></li>
</ul>
</section>
<section id="update-log" class="level2">
<h2 class="anchored" data-anchor-id="update-log">UPDATE Log</h2>
<p>[27th January, 2022] Add CI pipeline example for Bitbucket and Github Action.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>